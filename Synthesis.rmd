---
title: "Synthesis exercise:  of Miccroarray Data Analysis" 
author: "Sara LÃ³pez Ruiz de Vargas"
output: html_document 
---


#13-cis retinoic treatment of human sebocytes (SEB-1) - GSE10432


##Description of the study 
The title of the study is 13-cis retinoic treatment of human sebocytes SEB-1. The organism tested is human. 
The main objective is to study the sebocyte-specific mechanism of action by analyzing the effects of 72 hour 13-cis RA treatment on cultured human sebocyte cells (SEB-1), to gain insight on the pathogenesis of acne 

##Brief description of the data
First we need to load the data and extract the expression set :
```{r}
library(Biobase)
library(GEOquery)
eset <- getGEO('GSE10432')[[1]]
class(eset)
```

Now let's examine the data inside this Expression set. 
* Numerical summary : 
```{r}
summary(exprs(eset))
```


* Histogram of the frequency of the expression values
```{r}
hist(exprs(eset))
```

* Histogram for the std deviation of expression values 
```{r}
stdDev = apply(exprs(eset), 1, sd)
hist(stdDev)
```


##Experimental design 
* Response variable: Expression of genes
* Groups and levels: Group control and group treated
* Type of experimental design: Completely randomized design
* Sample size and number of experimental units per combination of factors: Total sample size of six, three treated and three control

##Comparisons between groups 
The comparison I deem more interesting given the study is trated vs. non-treated.
* A set of possible interesting comparisons :
  b1 = s4- s1
  b2 = s5 - s2
  b3 = s6 - s3
  
##Design matrix and contrast matrix

###Design matrix


```{r designMatrix}
design<-matrix(
  c(0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0 , 0),
  nrow=6,byrow=F)
colnames(design) <- c("Treated", "Control")
rownames(design) <- c("GSM263915","GSM263916", "GSM263917", "GSM263918", "GSM263919", "GSM263920")
print(design)

```

###Contrast matrix 
```{r contrastsMatrix}
require(limma)
cont.matrix <- makeContrasts (
  c1 = Treated - Control,  
  levels=design)
print(cont.matrix)
```

##Linear model 
```{r fitModel}
require(limma)
fit<-lmFit(eset, design)
fit.main<-contrasts.fit(fit, cont.matrix)
fit.main<-eBayes(fit.main)
```
```{r extractResults}
topTab_TvsC <- topTable (fit.main, number=nrow(fit.main), coef="c1", adjust="fdr"); head(topTab_TvsC)

```

```{r showResults}
volcanoplot(fit.main, coef="c1", highlight=10)

```


